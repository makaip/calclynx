<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MathGene Derivative Test</title>
</head>
<body>
    <h1>MathGene Derivative Testing</h1>
    <div id="results"></div>

    <script src="libs/mathgene/mg_translate.js"></script>
    <script src="libs/mathgene/mg_calculate.js"></script>
    <script>
        const results = document.getElementById('results');
        
        function testDerivative(expression, variable, expected, description) {
            try {
                // Test the internal derivative function
                const result = mgCalc.Derivative(expression, variable);
                const simplified = mgCalc.Simplify(result);
                
                results.innerHTML += `
                    <div>
                        <h3>${description}</h3>
                        <p><strong>Expression:</strong> ${expression}</p>
                        <p><strong>Variable:</strong> ${variable}</p>
                        <p><strong>Result:</strong> ${result}</p>
                        <p><strong>Simplified:</strong> ${simplified}</p>
                        <p><strong>Expected:</strong> ${expected}</p>
                        <hr>
                    </div>
                `;
            } catch (error) {
                results.innerHTML += `
                    <div>
                        <h3>${description} - ERROR</h3>
                        <p><strong>Expression:</strong> ${expression}</p>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <hr>
                    </div>
                `;
            }
        }

        // Test basic derivative functionality once we implement it
        console.log("Testing derivative functionality...");
        
        // Test the new public Derivative functions
        testDerivative("x^2", "x", "2*x", "Power Rule: x²");
        testDerivative("x^3", "x", "3*x^2", "Power Rule: x³");
        testDerivative("sin(x)", "x", "cos(x)", "Trigonometric: sin(x)");
        testDerivative("cos(x)", "x", "-sin(x)", "Trigonometric: cos(x)");
        testDerivative("e^x", "x", "e^x", "Exponential: e^x");
        testDerivative("ln(x)", "x", "1/x", "Logarithmic: ln(x)");
        testDerivative("x*sin(x)", "x", "sin(x)+x*cos(x)", "Product Rule: x*sin(x)");
        testDerivative("sin(x)/x", "x", "(x*cos(x)-sin(x))/x^2", "Quotient Rule: sin(x)/x");
        testDerivative("sin(x^2)", "x", "2*x*cos(x^2)", "Chain Rule: sin(x²)");
        
        // Test higher order derivatives
        function testHigherDerivative(expression, variable, order, description) {
            try {
                const result = mgCalc.Derivative(expression, variable, order);
                const simplified = mgCalc.Simplify(result);
                
                results.innerHTML += `
                    <div>
                        <h3>${description} (Order ${order})</h3>
                        <p><strong>Expression:</strong> ${expression}</p>
                        <p><strong>Variable:</strong> ${variable}</p>
                        <p><strong>Result:</strong> ${result}</p>
                        <p><strong>Simplified:</strong> ${simplified}</p>
                        <hr>
                    </div>
                `;
            } catch (error) {
                results.innerHTML += `
                    <div>
                        <h3>${description} (Order ${order}) - ERROR</h3>
                        <p><strong>Expression:</strong> ${expression}</p>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <hr>
                    </div>
                `;
            }
        }
        
        testHigherDerivative("x^4", "x", 2, "Second derivative of x⁴");
        testHigherDerivative("sin(x)", "x", 2, "Second derivative of sin(x)");
        
        // Test gradient for multivariable functions
        function testGradient(expression, variables, description) {
            try {
                const result = mgCalc.Gradient(expression, variables);
                
                results.innerHTML += `
                    <div>
                        <h3>${description}</h3>
                        <p><strong>Expression:</strong> ${expression}</p>
                        <p><strong>Variables:</strong> ${variables}</p>
                        <p><strong>Gradient:</strong> [${result.join(", ")}]</p>
                        <hr>
                    </div>
                `;
            } catch (error) {
                results.innerHTML += `
                    <div>
                        <h3>${description} - ERROR</h3>
                        <p><strong>Expression:</strong> ${expression}</p>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <hr>
                    </div>
                `;
            }
        }
        
        testGradient("x^2 + y^2", ["x", "y"], "Gradient of x² + y²");
        testGradient("x*y + sin(x)", ["x", "y"], "Gradient of x*y + sin(x)");
        
        console.log("Derivative tests completed");
    </script>
</body>
</html>
